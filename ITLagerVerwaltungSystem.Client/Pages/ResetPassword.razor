@page "/resetpassword"
@inject HttpClient Http

<PageTitle>Reset Password</PageTitle>

<h3>Reset Password</h3>

@if (!string.IsNullOrEmpty(message))
{
    <div class="alert alert-info">@message</div>
}

<EditForm Model="resetModel" OnValidSubmit="HandleReset">
    <DataAnnotationsValidator />
    <ValidationSummary />
    <div class="mb-3">
        <label>Email</label>
        <InputText @bind-Value="resetModel.Email" class="form-control" />
    </div>
    <button class="btn btn-primary" type="submit">Send Reset Link</button>
</EditForm>

@code {
    private ResetModel resetModel = new();
    private string? message;

    private async Task HandleReset()
    {
        var response = await Http.PostAsJsonAsync("api/auth/resetpassword", new { Email = resetModel.Email });
        if (response.IsSuccessStatusCode)
        {
            message = "If your email is registered, a reset link has been sent.";
        }
        else
        {
            message = "Failed to send reset link. Please try again.";
        }
    }

    public class ResetModel
    {
        public string Email { get; set; } = string.Empty;
    }
}
